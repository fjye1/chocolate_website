{% extends "Admin/admin_base.html" %}
{% block title %}Admin Home{% endblock %}

{% block admin_block %}


<table class="table table-striped">
    <thead>
    <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Price (avg)</th>
        <th>Active</th>
        <th>Quantity</th>
        <th>Earliest Expiry</th>
        <th>Days till earliest expire</th>
        <th>Tags</th>
        <th>Actions</th>
        <th>Dynamic Pricing</th>
        <th>Price alert average</th>
        <th colspan="3" class="text-center">Last 28 Days</th>
    </tr>
    <tr>
        <th colspan="11"></th>
        <th>Revenue</th>
        <th>Profit</th>
        <th>Profit %</th>
    </tr>
    </thead>
    <tbody>
    {% for product in products %}
    <tr>
        <td><img src="/{{ product.image }}" width="100"></td>
        <td>{{ product.name }}</td>
        <td>₹{{ "%.2f"|format(product.avg_price) }}</td>
        <td>{{ "Yes" if product.has_active_boxes else "No" }}</td>
        <td>{{ product.total_quantity }}</td>
        <td>{{ product.earliest_expiry.strftime('%d %b %Y') if product.earliest_expiry else "-" }}</td>
        <td>{{ product.days_left if product.earliest_expiry else "-" }}</td>
        <td>{{ product.tag_names }}</td>

        <td>
            <a href="{{ url_for('admin_edit_product', product_id=product.id) }}"
               class="btn btn-sm btn-primary">
                Edit
            </a>
        </td>


        <td>{{ "On" if product.dynamic_pricing_enabled else "Off" }}</td>
        <td>₹{{ "%.2f"|format(product.avg_alert_price) }}</td>
        <td>₹{{ "%.2f"|format(product.total_revenue) }}</td>
        <td>₹{{ "%.2f"|format(product.profit) }}</td>
        <td>{{ "%.2f"|format(product.profit_percent) }}%</td>
    </tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}